import time
import math
def rmf_factor(n):
    """
    Ğ•Ğ²Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¸Ğ¹ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼ Ñ€Ğ¾Ğ·ĞºĞ»Ğ°Ğ´Ğ°Ğ½Ğ½Ñ Ñ‡Ğ¸ÑĞ»Ğ° Ğ½Ğ° Ğ¼Ğ½Ğ¾Ğ¶Ğ½Ğ¸ĞºĞ¸:
    Ğ°Ğ½Ğ°Ğ»Ñ–Ğ·ÑƒÑ” Ğ·Ğ¼Ñ–Ğ½Ñƒ Ğ·Ğ°Ğ»Ğ¸ÑˆĞºÑƒ Ğ¿Ñ€Ğ¸ Ğ·Ğ¼ĞµĞ½ÑˆĞµĞ½Ğ½Ñ– Ğ´Ñ–Ğ»ÑŒĞ½Ğ¸ĞºĞ° y,
    Ñ– Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°Ñ” Ğ½ĞµĞ¿ĞµÑ€ÑĞ¿ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ– Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ (Ğ¿Ñ–Ğ´Ğ¹Ğ¾Ğ¼Ğ¸ Ğ·Ğ°Ğ»Ğ¸ÑˆĞºÑƒ).
    """
    y_max = math.isqrt(n) + 1  # Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ´Ñ–Ğ»ÑŒĞ½Ğ¸Ğº â€” ĞºĞ¾Ñ€Ñ–Ğ½ÑŒ Ğ· n
    z_prev = n  # Ğ¿Ğ¾Ğ¿ĞµÑ€ĞµĞ´Ğ½Ñ–Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº (Ğ¿Ğ¾Ñ‡Ğ°Ñ‚ĞºĞ¾Ğ²Ğ¾ n % n = 0)

    t0 = time.time()
    y = y_max

    while y > 2:
        z = n % y  # Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº Ğ¿Ñ€Ğ¸ Ğ´Ñ–Ğ»ĞµĞ½Ğ½Ñ– n Ğ½Ğ° Ğ¿Ğ¾Ñ‚Ğ¾Ñ‡Ğ½Ğµ y
        y_next = y - 1
        z_next = n % y_next if y_next > 1 else n  # Ğ½Ğ°ÑÑ‚ÑƒĞ¿Ğ½Ğ¸Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº

        # âœ… Ğ¯ĞºÑ‰Ğ¾ Ğ·Ğ½Ğ°Ğ¹ÑˆĞ»Ğ¸ Ğ´Ñ–Ğ»ÑŒĞ½Ğ¸Ğº â€” Ğ¿Ğ¾Ğ²ĞµÑ€Ñ‚Ğ°Ñ”Ğ¼Ğ¾ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
        if z == 0:
            print(f"Ğ—Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ğ´Ñ–Ğ»ÑŒĞ½Ğ¸Ğº: {y}")
            return y, n // y

        # âš¡ Ğ•Ğ²Ñ€Ğ¸ÑÑ‚Ğ¸ĞºĞ°: ÑĞºÑ‰Ğ¾ z â€” Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼, Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°Ñ”Ğ¼Ğ¾ Ğ´ĞµĞºÑ–Ğ»ÑŒĞºĞ° y
        if z > z_prev and z < z_next:
            skip = int(math.sqrt(z))  # Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ¸Ğ¹ ĞºÑ€Ğ¾Ğº
            y -= skip  # Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°Ñ”Ğ¼Ğ¾ Ğ²Ğ¿ĞµÑ€ĞµĞ´
        else:
            y -= 1  # Ğ·Ğ²Ğ¸Ñ‡Ğ°Ğ¹Ğ½Ğ¸Ğ¹ ĞºÑ€Ğ¾Ğº

        z_prev = z  # Ğ·Ğ±ĞµÑ€Ñ–Ğ³Ğ°Ñ”Ğ¼Ğ¾ Ğ¿Ğ¾Ğ¿ĞµÑ€ĞµĞ´Ğ½Ñ–Ğ¹ Ğ·Ğ°Ğ»Ğ¸ÑˆĞ¾Ğº

    t1 = time.time()
    print(f"Ğ§Ğ¸ÑĞ»Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ğµ. Ğ§Ğ°Ñ: {t1 - t0:.2f} ÑĞµĞº")
    return None


# ğŸ§ª ĞŸÑ€Ğ¸ĞºĞ»Ğ°Ğ´ Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ°Ğ½Ğ½Ñ â€” Ğ¿Ñ€Ğ¾ÑÑ‚Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾ ĞœĞµÑ€ÑĞµĞ½Ğ½Ğ° (2^61 - 1)
n = 2305843009213693951
result = rmf_factor(n)
print("Result:", result)
