import time
import math
def rmf_factor(n):
    """
    –ï–≤—Ä–∏—Å—Ç–∏—á–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–æ–∑–∫–ª–∞–¥–∞–Ω–Ω—è —á–∏—Å–ª–∞ –Ω–∞ –º–Ω–æ–∂–Ω–∏–∫–∏:
    –∞–Ω–∞–ª—ñ–∑—É—î –∑–º—ñ–Ω—É –∑–∞–ª–∏—à–∫—É –ø—Ä–∏ –∑–º–µ–Ω—à–µ–Ω–Ω—ñ –¥—ñ–ª—å–Ω–∏–∫–∞ y,
    —ñ –ø—Ä–æ–ø—É—Å–∫–∞—î –Ω–µ–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è (–ø—ñ–¥–π–æ–º–∏ –∑–∞–ª–∏—à–∫—É).
    """
    y_max = math.isqrt(n) + 1  # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –¥—ñ–ª—å–Ω–∏–∫ ‚Äî –∫–æ—Ä—ñ–Ω—å –∑ n
    z_prev = n  # –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ª–∏—à–æ–∫ (–ø–æ—á–∞—Ç–∫–æ–≤–æ n % n = 0)

    t0 = time.time()
    y = y_max

    while y > 2:
        z = n % y  # –∑–∞–ª–∏—à–æ–∫ –ø—Ä–∏ –¥—ñ–ª–µ–Ω–Ω—ñ n –Ω–∞ –ø–æ—Ç–æ—á–Ω–µ y
        y_next = y - 1
        z_next = n % y_next if y_next > 1 else n  # –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ª–∏—à–æ–∫

        # ‚úÖ –Ø–∫—â–æ –∑–Ω–∞–π—à–ª–∏ –¥—ñ–ª—å–Ω–∏–∫ ‚Äî –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        if z == 0:
            print(f"–ó–Ω–∞–π–¥–µ–Ω–æ –¥—ñ–ª—å–Ω–∏–∫: {y}")
            return y, n // y

        # ‚ö° –ï–≤—Ä–∏—Å—Ç–∏–∫–∞: —è–∫—â–æ z ‚Äî –ª–æ–∫–∞–ª—å–Ω–∏–π –º–∞–∫—Å–∏–º—É–º, –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –¥–µ–∫—ñ–ª—å–∫–∞ y
        if z > z_prev and z > z_next:
            skip = int(math.sqrt(z))  # –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π –∫—Ä–æ–∫
            y -= skip  # –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –≤–ø–µ—Ä–µ–¥
        else:
            y -= 1  # –∑–≤–∏—á–∞–π–Ω–∏–π –∫—Ä–æ–∫

        z_prev = z  # –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ª–∏—à–æ–∫

    t1 = time.time()
    print(f"–ß–∏—Å–ª–æ –ø—Ä–æ—Å—Ç–µ. –ß–∞—Å: {t1 - t0:.2f} —Å–µ–∫")
    return None


# üß™ –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ‚Äî –ø—Ä–æ—Å—Ç–µ —á–∏—Å–ª–æ –ú–µ—Ä—Å–µ–Ω–Ω–∞ (2^61 - 1)
n = 2305843009213693951
result = rmf_factor(n)
print("Result:", result)
